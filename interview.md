# 简历详解

## 自我介绍

面试官您好，我叫张辉，是一名23届的应届生，专业是软件工程。

目前是在一家公司做Java实习生的工作，主要负责的内容是数据的清洗和转换。

自己也做过一些项目，有Java的也有Go的，在开发中都是选择项目中的难点来开发并以此锻炼自己。

自己本人是非常热爱技术，对软件开发和底层实现都有着浓厚的兴趣，热衷于阅读各种技术书籍，喜欢同其他人探讨。

以上就是我的自我介绍，谢谢面试官。

## 项目

### 极简版抖音

#### 项目介绍

一句话介绍，实现极简版抖音。每一个应用都是从基础版本逐渐发展迭代过来的，希望同学们能通过实现一个极简版的抖音，来切实实践课程中学到的知识点，如Go语言编程，常用框架、数据库、对象存储等内容，同时对开发工作有更多的深入了解与认识，长远讲能对大家的个人技术成长或视野有启发。

#### 涉及技术

Go、Gin、Gorm、OSS、FFmpeg、Token、MySql、Redis（不是我做的不太了解）

#### 我所做的

1 使用OSS和FFmpeg完成用户投稿的功能，通过使用协程的异步优化此流程使得响应时间从原来的20+s 降低到了5~7s。 

2 使用Viper做反序列化，实现配置文件的读取,完成配置的初始化工作。

3 使用Token作为拦截器，完成对非法请求的拦截和过滤的功能。

4  完成了用户模块、评论模块、视频投稿模块和基本信息模块的代码的编写和功能的实现。 

#### 原理分析

##### 一  优化问题

###### OSS

首先就是OSS，OSS全程是Object Storage Service（对象存储服务），具有易扩展、易用（支持RestFul，而传统的HDFS是支持TCP私有协议的，如果想使用HDFS还需要再代码中内嵌一个客户端才行）、便宜等特点，适合存储海量数据。

所以我们就选用了OSS对象存储服务。

###### FFmpeg

FFmpeg是用来做视频处理的一个工具，我这里就是使用ffmpeg实现了视频截取封面的功能。

###### 流程优化

下面来聊一下我是怎么做的优化。

原来的流程是这样的 

1 用户在客户端调用接口上传视频

2 服务端接收到用户上传的视频数据调用oss上传文件的接口完成视频的上传、视频上传完成，服务端得到视频的url。

3 以url为参数，调用ffmpeg完成封面图的截取并存储在本地、然后调用oss文件上传接口完成封面图的上传，服务端得到封面图的url。

4 至此，用户所有数据都已经上传到oss，服务端调用数据库存储接口完成将用户信息、视频和封面图存入MySql。

5 返回响应的数据告知客户端上传完成

使用这一套流程在测试的时候接口的响应时间平均在15s+以上，客户端时常会收到请求响应超时的错误，后来下定决心优化流程，优化过程中使用了Go的协程，优化后的效果非常好，接口的响应时间平均在5s+。下面看下优化后的流程

1 用户在客户端调用接口上传视频

2 提前定义好封面图的url，用于后面的异步操作

3 服务端接收到用户上传的视频数据调用oss上传文件的接口完成视频的上传、视频上传完成，服务端得到视频的url。

4 以url为参数，开启一个协程调用ffmpeg完成封面图的截取并存储在本地、然后调用oss文件上传接口完成封面图的上传，服务端得到封面图的url。

5 不需要等步骤4完成，直接调用数据库存储接口完成将用户信息、视频和封面图存入MySql。

6 返回响应的数据告知客户端上传完成。

##### 二 序列化问题

[序列化相关文章](https://zhuanlan.zhihu.com/p/40462507)

**序列化：**把对象转化为可传输的字节序列过程称为序列化。

**反序列化：**把字节序列还原为对象的过程称为反序列化。

其实序列化最终的目的是为了对象可以**跨平台存储，和进行网络传输**。而我们进行跨平台存储和网络传输的方式就是IO，而我们的IO支持的数据格式就是字节数组。

因为我们单方面的只把对象转成字节数组还不行，因为没有规则的字节数组我们是没办法把对象的本来面目还原回来的，所以我们必须在把对象转成字节数组的时候就制定一种规则**（序列化）**，那么我们从IO流里面读出数据的时候再以这种规则把对象还原回来**（反序列化）。**

默认的序列化ID和声明的ID是有区别的，如果使用默认的ID，当类属性发送变化的时候，反序列化就会失败，而有时候我们想做到兼容，所以推荐使用声明的ID，在这种情况下，可以做到版本的兼容，即使类文件发送的改变，序列化ID是显示指定的，从而不会导致反序列化失败。

##### 三 JWT问题

[Cookie、Session、Token 视频](https://www.bilibili.com/video/BV1ob4y1Y7Ep?spm_id_from=333.337.search-card.all.click&vd_source=ed7e751a69384a4f5cb20556664b84d4)

[腾讯云社区文章 Cookie Session Token](https://cloud.tencent.com/developer/article/1542456)

[Session的创建过程](https://www.cnblogs.com/woshimrf/p/5317776.html)

token和jwt是区别的 

token实际上是一种加强过的SessionId

为什么说是加强呢？是因为token不需要存储在服务器端，具有这个优势，所以说是加强

但是还有一个问题，就是token里面的数据比较少，可能需要查库从而获取数据

那为什么不在token里面放上数据呢？ 这里是安全性的考虑，如果直接放明文数据的话，会造成数据安全的问题。

那么有没有一种办法解决呢？

当然，加密就行了，这就是jwt所作的事情。

[jwt和token的区别案例](https://www.icode9.com/content-4-886449.html)

jwt比Session好在哪里？ 好在了不需要存储，但是多了解密这一步，也就是常说的时间换空间

jwt比Cookie好在哪里？一个是安全性，一个是简洁性（即没有跨域限制）

[跨域相关问题](https://www.cnblogs.com/kgwei520blog/p/13667378.html)



### 智慧路灯系统

#### 项目介绍

是⼀个完整的前后端分离的以路灯为基础的物联⽹系统，路灯上可以安装包括但不限于摄像头、报警器、⼴播、⼤屏等设备。

主要功能是通过智慧路灯物联⽹平台完成在⽹⻚端对路灯的控制,进⽽完成对以上设备的控制。

此系统通过技术⼿段解决了⽤户管理多个设备复杂性，通过⼀个系统就可以完成对所有设备的控制。

#### 涉及技术

Java springboot mybatis MySql  Go Redis webrtc

#### 我所做的

1 使⽤Go语⾔完成⽹⻚端⽆插件直播功能的开发，采⽤了webrtc技术优化视频的播放,使⽤户可以在⽹⻚ 端以极低延迟的感受观看直播和视频的回放。 

2 完成云台控制后台的开发，实现在⽹⻚端完成对摄像头的控制，使⽤Java语⾔完成基于sdk的二次开发。 

3 使用redis作为缓存系统,使得首页的响应速度提高了大约30%。

#### 原理分析

##### 一 RTSP

rtsp，英文全称 Real Time Streaming Protocol，RFC2326，实时流传输协议，是TCP/IP协议体系中的一个应用层协议！协议主要规定定了一对多应用程序如何有效地通过IP网络传送多媒体数据。RTSP体系结位于RTP和RTCP之上（RTCP用于控制传输，RTP用于数据传输），使用TCP或UDP完成数据传输！
[RTSP交互流程](https://blog.csdn.net/sinat_36002055/article/details/123801585)

[RTSP操作大华摄像头](https://blog.csdn.net/lbjbs/article/details/117455605)

流程如下

前端js与Go的服务器通过http交互，完成RTSP的交互流程

这里Go的服务器中内置了一个RTSP的Client，使用RTSP协议完成流媒体数据的获取

这里实际上和webrtc没有半毛钱关系，使用的其实是rtsp协议去做的视频消息的传输。

但还是要比ffmpeg去做这个效果来的快得多，而且延迟也大大的小于ffmpeg。

##### 二 云台控制相关问题

使用的websocket长连接去做的。 [websocket](https://zh.m.wikipedia.org/zh-hans/WebSocket)

这里考虑用websoket主要是考虑到服务端主动给客户端发消息。

服务端收到前端传递过来的参数后调用sdk完成对摄像头的控制，没有考虑并发问题。

##### 三 Redis提速

将一些复杂的数据存入到redis中，不用每次都去数据库查询，极大的提高了首页的打开的速度。

查询

先查询redis，redis没有在查询mysql，然后把查询到的数据存入到redis。

更新

这里就有一个问题，到底是先删除缓存还是先删除mysql

看第一种

**先删缓存，再更新数据库**

该方案会导致请求数据不一致

同时有一个请求A进行更新操作，另一个请求B进行查询操作。那么会出现如下情形:

（1）请求A进行写操作，删除缓存

（2）请求B查询发现缓存不存在

（3）请求B去数据库查询得到旧值

（4）请求B将旧值写入缓存

（5）请求A将新值写入数据库

上述情况就会导致不一致的情形出现。而且，如果不采用给缓存设置过期时间策略，该数据永远都是脏数据。

看下一种

**先删数据库，再更新redis 缓存 缓存没有失效**

同时有一个请求A进行更新操作，另一个请求B进行查询操作。那么会出现如下情形:

（1）请求A进行写操作，删除数据库

（2）请求B查询发现缓存存在 直接返回（脏数据）

（3）请求A更新缓存，将缓存删除

可见这时只会造成一段时间内的脏数据，当下次请求过来的时候会由于没有缓存的原因会直接查询数据库然后更新缓存。

**先删数据库，再更新redis 缓存 缓存失效**

假设这会有两个请求，一个请求A做更新操作，一个请求B做查询操作，那么会有如下情形产生

（1）缓存刚好失效

（2）请求B查询数据库，得一个旧值

（3）请求A将新值写入数据库

（4）请求A删除缓存

（5）请求B将查到的旧值写入缓存

ok，如果发生上述情况，确实是会发生脏数据。

然而，发生这种情况的概率又有多少呢？

发生上述情况有一个先天性条件，就是步骤（3）的写数据库操作比步骤（2）的读数据库操作耗时更短，才有可能使得步骤（4）先于步骤（5）。可是，大家想想，**数据库的读操作的速度远快于写操作的（不然做读写分离干嘛，做读写分离的意义就是因为读操作比较快，耗资源少），因此步骤（3）耗时比步骤（2）更短，这一情形很难出现。**

**先更新数据库，再删缓存依然会有问题，不过，问题出现的可能性会因为上面说的原因，变得比较低！**

所以，如果你想实现基础的缓存数据库双写一致的逻辑，那么在大多数情况下，在不想做过多设计，增加太大工作量的情况下，请**先更新数据库，再删缓存!**





## 技术问题

### 金康赛力斯（北京）

spring 事务了解吗

聊一下事务，什么是事务

mysql事务隔离级别了解吗

spring ioc讲一讲

tcp为什么要三次握手，两次不行吗

linux下查询指定端口用什么命令

linux下查询日志的命令呢

聊一聊你的项目主要做了什么

集合用的多吗，项目中集合用来做什么

spring的@Autowired和@Resource有什么区别



### 星辰物联网（北京）

java多线程实现方式有几种

java的lambda表达式是什么

java涉及到io的类有哪些

springboot启动类是什么，用的哪一个注解

java多线程传递消息怎么做

jvm垃圾回收算法有哪些，区别是什么

怎么区别新生代和老年代

策略模式怎么去写

mysql分页查询怎么用

mysql索引分类有哪些

redis常见的数据类型有哪些

选择排序和冒泡有什么不一样吗

消息队列kafka怎样保证数据不丢的

git常用操作



### 火树科技（杭州）

实习工作详解

es和lussen内存布局有什么区别

单例线程安全的操作

jvm内存区域

工厂的几种写法

nio对比io有什么优势



### 奇安信

Java线程池详解

tcp握手的序号问题  ack的计算规则

子网划分问题 C类地址

统计log文件中某一个字符出现的次数

hashmap的问题 是否有序

mysql的s锁和x锁

函数中的final字段在哪一个区  final字段的含义有什么

粘包问题怎么解决

进程让出cpu后处于什么状态

mysql联合索引的特性

排序算法 是否稳定

lru算法

合并区间问题

全排列



### 京东

final的用法

mysql增加多个字段

String.format的用法

ls列出隐藏文件

osi数据链路层的作用

String的spilt和indexof的性能

线程池 submit和execute有什么区别

linux中系统库文件存放的目录

java权限修饰符

lsd和msd

二叉树的遍历问题

short的比较 参考Integer的比较

大字符串的创建 StringBuf和StringBuilder有什么区别

### 巨峰科技（杭州）

反射

GC线程

重写和重载

异常体系

abstract关键字

string和int转换

8大基本数据类型

字符流和字节流

java有内存泄漏吗









